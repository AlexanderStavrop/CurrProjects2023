\section*{Εισαγωγή}
Στην πρώτη άσκηση ζητείται η υλοποίηση δύο αλγορίθμων του ε-Greedy και Upper Bound Confidence, oι οποίοι επιτυγχάνουν ισορροπία μεταξύ exploration και exploitation στο γνωστό πρόβλημα κουλοχέρηδων(Bandits Problem). 

\subsection*{ε-Greedy}
\noindent
Στο αλγόριθμος ε-Greedy στην περίπτωση exploration επιλέγεται ένα χέρι τυχαίο χέρι ανεξάρτητα των επιδόσεών του έως τώρα ενώ στην περίπτωση exploitation επιλέγεται το χέρι το οποίο παρουσιάζει την καλύτερη επίδοση έως τώρα. Η επίδοση κάθε χεριού ορίζεται μέσω του συντελεστή $\mu$ ο οποίος είναι ίσος με τον πηλίκο μεταξύ του σκορ που έχει μαζέψει το εκάστοτε χέρι προς τον αριθμό των φορών που έχει επιλεχθεί. Το σκορ προκύπτει ως το γινόμενο μεταξύ reward και διωνυμικής πιθανότητας κάθε χεριού. 

\noindent\\
Η επιλογή μεταξύ exploitation και exploitation γίνεται με χρήση της μεταβλητής epsilon η οποία ορίζεται ως εξής:
\begin{equation*}
	epsilon = (t)^{-\frac{1}{3}} \cdot (k \cdot \log(t))^{\frac{1}{3}}
\end{equation*}

\noindent
Σε κάθε γύρο, με πιθανότητα epsilon γίνεται explore ενώ με πιθανότητα 1 - epsilon γίνεται exploit και λαμβάνοντας υπόψιν τον φθίνον ρυθμό της μεταβλητής epsilon, είναι εμφανές πως όσο αυξάνονται οι γύροι τόσο πιο πιθανό είναι να γίνει exploitation χρησιμοποιώντας το καλύτερο χέρι και ταυτόχρονα τόσο πιο απίθανο να επιλεγεί κάποιο τυχαίο (exploration). Τέλος, ο αλγόριθμος παρουσιάζει πολυπλοκότητα ίση με:
\begin{equation}
	O\left( (t)^{\frac{2}{3}} \cdot (K \cdot \log(t))^{\frac{1}{3}} \right)
\end{equation}



\subsection*{Upper Bound Confidence}
\noindent
Στο αλγόριθμος Upper Bound Confidence (UBC) η επιλογή χεριού γίνεται με βάση τον συντελεστή ubc:
\begin{equation}
	ucb = \mu + \sqrt{\frac{\log T}{Q} }
\end{equation}

όπου $\mu$ ο συντελεστής επίδοσης κάθε χεριού, Τ ο ορίζοντας και Q οι φορές που έχει επιλεχθεί το αντίστοιχο χέρι.

\noindent\\
Σε κάθε γύρο επιλέγεται το χέρι το οποίο παρουσιάζει μεγαλύτερο συντελεστή ucb κάτι το οποίο μπορεί να προκύψει είτε λόγο καλής επίδοσης (λόγο του συντελεστή $\mu$) είτε επειδή έχουν περάσει πολλοί γύροι που δεν έχει επιλεχθεί το εκάστοτε χέρι. Αυτό έχει ως αποτέλεσμα, το exploration πρακτικά να μην σταματάει ποτέ καθώς ακόμα και για μεγάλο αριθμό γύρου, ανά διαστήματα επιλέγεται ένα υπόλοιπα χέρια και αξιολογείται εκ νέου το performance του κάτι το οποίο στον ε-Greedy είναι σχεδόν απίθανο να συμβεί για μεγάλο αριθμό γύρων.


\noindent\\\\\\\\\\
O UBC αξιοποιεί και αυτός με την σειρά του τον συντελεστή $\mu$ ωστόσο δεν υπάρχει μεταβλητή epsilon η οποία να καθορίζει την πιθανότητα μεταξύ exploration και exploitation αλλά ορίζεται μέσω της μεταβλητής ucb. Σε κάθε γύρο 




\noindent\\\\\\\\
στην περίπτωση exploration επιλέγεται ένα χέρι τυχαίο χέρι ανεξάρτητα των επιδόσεών του έως τώρα ενώ στην περίπτωση exploitation επιλέγεται το χέρι το οποίο παρουσιάζει την καλύτερη επίδοση έως τώρα. Η επίδοση κάθε χεριού ορίζεται μέσω του συντελεστή $\mu$ ο οποίος είναι ίσος με τον πηλίκο μεταξύ του σκορ που έχει μαζέψει το εκάστοτε χέρι προς τον αριθμό των φορών που έχει επιλεχθεί. Το σκορ προκύπτει ως το γινόμενο μεταξύ reward και διωνυμικής πιθανότητας κάθε χεριού. 



\clearpage


ΣΕ αντίθεση με τον epsilon, ο UCB δίνει την ευκαιρία σε κάποια χέρια να επιλεχθούν εφόσον έχουν περάσει πολλοί γύροι χωρίς να έχουν επιλεγεί


\label{ex1}
\addcontentsline{toc}{section}{\nameref{ex1}}

\subsection*{Ερώτημα 1}
\label{ex1q1}
\addcontentsline{toc}{subsection}{\nameref{ex1q1}}

Δεδομένου του ότι η Alice έχει 50 φίλους και κάθε μέρα στέλνει ένα email το οποίο είναι μολυσμένο, η πιθανότητα να σταλεί σε ένα συγκεκριμένο φίλο της το mail είναι ίση με $\frac{1}{50}$. Η πιθανότητα αυτή είναι ίση για κάθε έναν από τους φίλους της και δεν επηρεάζεται από το αν στο παρελθόν ο εκάστοτε φίλος έχει λάβει μολυσμένο email.

\noindent\\
Η πιθανότητα να σταλεί email σε φίλο ο οποίος προηγουμένως δεν έχει μολυνθεί  αλλάζει με την πάροδο του χρόνου και γίνεται όλο και μικρότερη. Πιο συγκεκριμένα, την πρώτη φορά που στέλνεται ένα email, είναι σίγουρο πως θα σταλεί σε φίλο ο οποίος δεν έχει λάβει προηγουμένως, δηλαδή $p_i = 1$. Την δεύτερη φορά, για να μολυνθεί κάποιος νέος φίλος πρέπει να γίνει επιλογή μεταξύ των υπόλοιπων 49, το οποίο σημαίνει πως η πιθανότητα να μολυνθεί δεύτερο άτομο είναι ίση με $p_i = \frac{49}{50}$. Αντίστοιχα, για να μολυνθεί και τρίτο διαφορετικό άτομο η πιθανότητα είναι ίση με $p_i = \frac{48}{50}$ κ.ο.κ.

\noindent\\
Αναπτύσσοντας την παραπάνω σκέψη, η πιθανότητα για την μόλυνση του i-οστού νέου ατόμου προκύπτει ως εξής:
\begin{equation}
	p_i  = \frac{N - i}{N} \label{p_i_1}
\end{equation}

όπου Ν ο αριθμός των φίλων της Alice.


\noindent\\\\
Η αναμενόμενη τιμή για την μόλυνση του i-οστού ατόμου προκύπτει ως εξής:
\begin{align}
	E\left[i\right] = \frac{1}{p_i} = \frac{N}{N - i} \label{E_i_1}
\end{align}
Ελέγχοντας τις τιμές της αναμενόμενης τιμής παρατηρείται το εξής:
\begin{align}
	E\left[n\right] = E\left[n - 1\right] + \frac{1}{p_{n-1}} &\xRightarrow{}  E\left[n\right] = E\left[n - 2\right] + \frac{1}{p_{n-2}} + \frac{1}{p_{n-1}}  \notag \\
																										& \hspace{3.3cm} \vdots \notag\\
																										& \xRightarrow{} E\left[n\right] = \frac{1}{p_{0}}  + \frac{1}{p_{1}} + \cdots  + \frac{1}{p_{n-2}} + \frac{1}{p_{n-1}} \notag
\end{align}
 
και αντικαθιστώντας την σχέση (\ref{E_i_1}) η παραπάνω σχέση μπορεί να μετασχηματιστεί ως εξής:
\begin{align}
	E\left[n\right] = \frac{1}{p_{0}}  + \frac{1}{p_{1}} + \cdots  + \frac{1}{p_{n-2}} + \frac{1}{p_{n-1}}& \xRightarrow{} E\left[n\right] = \frac{N}{N - 0}  + \frac{N}{N - 1} + \cdots  + \frac{N}{N - (N-2)} + \frac{N}{N - (N-1)} \xRightarrow{}  \notag \\
																										  & \xRightarrow{} E\left[n\right] =  N \cdot \left(\frac{1}{N - 0}  + \frac{1}{N - 1} + \cdots  + \frac{1}{N - (N-2)} + \frac{1}{N - (N-1)} \right) \xRightarrow{}  \notag \\
																										  & \xRightarrow{} E\left[n\right] = N \cdot \left(\frac{1}{N}  + \frac{1}{N - 1} + \cdots  + \frac{1}{2} + 1 \right) \xRightarrow{}  \notag \\
																										  & \xRightarrow{} E\left[n\right] = N \cdot \sum_{n = 0}^{N - 1} \frac{1}{n - 1}
\end{align}

\noindent\\
Αντικαθιστώντας τον αριθμό των φίλων της Alice, δηλαδή Ν = 50 προκύπτει η εξής αναμενόμενη τιμή:
\begin{equation*}
	E\left[50\right] = 50 \cdot \sum_{n = 0}^{49}  \frac{1}{n - 1} = 224.96 \approx 225 \text{ μέρες}
\end{equation*}

δηλαδή απαιτούνται περίπου 225 ημέρες ώστε να μολυνθεί κάθε ένας από τους φίλους της Alice.

\clearpage
\subsection*{Ερώτημα 2}
\label{ex1q2}
\addcontentsline{toc}{subsection}{\nameref{ex1q2}}

Όπως προαναφέρθηκε στο προηγούμενο ερώτημα, η πιθανότητα να μολυνθεί ένας φίλος της Alice κάθε μέρα, είναι ίση με $\frac{1}{50}$. Γνωρίζοντας αυτό, η πιθανότητα να μην μολυνθεί ένας φίλος της Alice μία μέρα είναι ίση με $1 - \frac{1}{50} = \frac{49}{50}$ οπότε σε διάστημα 3 μηνών, δηλαδή 90 ημερών, η πιθανότητα να μην μολυνθεί ένας φίλος της Alice είναι ίση με: 
\begin{equation}
	P_{90} = \sum_{n=0}^{90} \left(1 - \frac{1}{50}\right) = \left(\frac{49}{50} \right)^{90} \label{p_90}
\end{equation}

οπότε η πιθανότητα να μολυνθεί ένας φίλος της Alice στις επόμενες 90 μέρες είναι ίση με:
\begin{equation}
	1 - P_{90} = 1 - \left(\frac{49}{50} \right)^{90} \label{P_90_bar}
\end{equation}

\noindent\\
Η πιθανότητα $\bar{P_{90}}$ αντιστοιχεί στην πιθανότητα να μολυνθεί ένας φίλος της Alice στις πρώτες 90 μέρες, και έτσι εφόσον η Alice έχει 50 φίλους, για την εύρεση του αριθμού των φίλων της που θα έχουν μολυνθεί στις πρώτες 90 μέρες αρκεί απλά να πολλαπλασιαστεί η πιθανότητα της σχέσης (\ref{P_90_bar} με τον αριθμό των φίλων της:
\begin{equation}
	\bar{P_{90}}= 50 \cdot \left(\frac{49}{50} \right)^{90} = 41.884 ή \approx 42 \text{ φίλοι} \label{P_90_bar_50}
\end{equation}